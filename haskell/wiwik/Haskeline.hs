import Control.Monad.Trans
import System.Console.Haskeline


type Repl a = InputT IO a

process :: String -> IO ()
process = putStrLn

repl :: Repl ()
repl = do
    minput <- getInputLine "Repl> "
    case minput of
        Nothing -> outputStrLn "Goodbye."
        Just input -> (liftIO $ process input) >> repl


main :: IO ()
main = runInputT defaultSettings repl
