In definition~(\ref{logic:def:strong:sub:congruence}) we initially
defined the strong substitution congruence thinking it was the
appropriate notion to study. We then realized in
proposition~(\ref{logic:prop:counter:strong:1}) and
proposition~(\ref{logic:prop:counter:strong:2}) that the strong
substitution congruence is in fact unsatisfactory in the case when
the set of variables $V$ has two or three elements. For example,
when $V=\{x,y\}$ with $x\neq y$, we saw that the formulas
$\phi=\forall x\forall y(x\in y)$ and $\psi=\forall y\forall x(y\in
x)$ failed to be equivalent. It is easy to believe that similar
failures can be uncovered whenever $V$ is a finite set. So we
decided to search for a new notion of {\em substitution congruence}
which led to definition~(\ref{logic:def:sub:congruence}). In this
section, we shall attempt to show that this new substitution
congruence has all the advantages of the strong substitution
congruence, but without its~flaws.

First we look at the paradox of
proposition~(\ref{logic:prop:counter:strong:1}). So let $V=\{x,y\}$
with $x\neq y$ and $\phi=\forall x\forall y(x\in y)$ with
$\psi=\forall y\forall x(y\in x)$. Then setting $\phi_{1}=\forall
y(x\in y)$ we have $\phi=\forall x\phi_{1}$ and $\psi=\forall
y\,\phi_{1}[y\!:\!x]$. Since $x\neq y$ and $y\not\in\free(\phi_{1})$
we conclude from definition~(\ref{logic:def:sub:congruence}) that
$\phi\sim\psi$ where $\sim$ denotes the substitution congruence. So
the paradox of proposition~(\ref{logic:prop:counter:strong:1}) is
lifted. Suppose now that $V=\{x,y,z\}$ where $x$, $y$ and $z$ are
distinct, and define $\phi= \forall x\forall y\forall z\,[(x\in
y)\to(y\in z)]$ and $\psi=\forall y\forall z\forall x\,[(y\in
z)\to(z\in x)]$. We claim that $\phi\sim\psi$. If this is the case,
then the paradox of proposition~(\ref{logic:prop:counter:strong:2})
is also lifted. Let $\chi$ be the formula defined by $\chi=\forall
y\forall x\forall z\,[(y\in x)\to(x\in z)]$. Then $\chi$ is simply
the formula obtained from $\phi$ by permuting the variables $x$ and
$y$. In order to show $\phi\sim\psi$ it is sufficient to prove that
$\phi\sim\chi$ and $\chi\sim\psi$. First we show that
$\phi\sim\chi$. Defining $\phi_{1}=\forall y\forall z\,[(x\in
y)\to(y\in z)]$ we have $\phi=\forall x\phi_{1}$ and $\chi=\forall
y\phi_{1}[y\!:\!x]$. Since $x\neq y$ and $y\not\in\free(\phi_{1})$
we conclude from definition~(\ref{logic:def:sub:congruence}) that
$\phi\sim\chi$. We now show that $\chi\sim\psi$. Setting
$\theta=\forall x\forall z\,[(y\in x)\to(x\in z)]$ together with
$\theta^{*}=\forall z\forall x\,[(y\in z)\to(z\in x)]$ we have
$\chi=\forall y\theta$ and $\psi=\forall y\theta^{*}$. It is
therefore sufficient to show that $\theta\sim\theta^{*}$. Defining
$\theta_{1}=\forall z\,[(y\in x)\to(x\in z)]$ we obtain
$\theta=\forall x\theta_{1}$ and $\theta^{*}=\forall
z\theta_{1}[z\!:\!x]$. Since $x\neq z$ and
$z\not\in\free(\theta_{1})$ we conclude from
definition~(\ref{logic:def:sub:congruence}) that
$\theta\sim\theta^{*}$. So we have proved that the substitution
congruence is not subject to the paradoxes of
proposition~(\ref{logic:prop:counter:strong:1}) and
proposition~(\ref{logic:prop:counter:strong:2}).


Having reviewed the known shortcomings of the strong substitution
congruence, we shall now establish that the new substitution
congruence is in fact pretty much the same notion as the old.
Specifically, we shall see that both congruences coincide when $V$
is an infinite set. Furthermore, even when $V$ is a finite set we
shall see that two formulas $\phi$ and $\psi$ which are simply
equivalent with respect to the substitution congruence, are in fact
strongly equivalent provided $\phi$ and $\psi$ do not use up all the
variables in $V$, i.e. $\var(\phi)\neq V$ or $\var(\psi)\neq V$.
First we check that the strong substitution congruence is indeed a
relation which is {\em stronger} than the substitution congruence:

\begin{prop}\label{logic:prop:strong:implies:quant}
Let $\sim$ be the substitution congruence and $\simeq$ be the strong
substitution congruence on \pv\ where $V$ is a set. Then for all
$\phi,\psi\in\pv$:
    \[
    \phi\simeq\psi\ \Rightarrow\ \phi\sim\psi
    \]
\end{prop}
\begin{proof}
We need to show the inclusion $\simeq\,\subseteq\,\sim$\,. However,
using definition~(\ref{logic:def:strong:sub:congruence}) the strong
substitution congruence $\simeq$ is generated by the following set:
    \[
    R_{0}=\left\{\,(\,\forall x\phi_{1}\,,\,\forall
    y\,\phi_{1}[y/x]\,):\phi_{1}\in\pv\ ,\ x,y\in V\ ,\ x\neq y\ ,\
    y\not\in\var(\phi_{1})\,\right\}
    \]
while from definition~(\ref{logic:def:sub:congruence}) the
congruence $\sim$ is generated by the set:
     \[
    R_{1}=\left\{\,(\,\forall x\phi_{1}\,,\,\forall y\,\phi_{1}[y\!:\!x]\,):
    \phi_{1}\in\pv\ ,\ x,y\in V\ ,\ x\neq y\ ,\ y\not\in\free(\phi_{1})\,\right\}
    \]
So it is sufficient to show that $R_{0}\subseteq R_{1}$ which
follows from the fact that $\phi_{1}[y/x]=\phi_{1}[y\!:\!x]$
whenever $y\not\in\var(\phi_{1})$ as can be seen from
proposition~(\ref{logic:prop:permutation:is:substitution}).
\end{proof}


\begin{prop}\label{logic:prop:link:strong:sub:congruence}
Let $\simeq$ be the strong substitution congruence on \pv\ where $V$
is a set. Let $\phi\in\pv$ such that $y\not\in\free(\phi)$ and
$\var(\phi)\neq V$. Then we have:
    \[
    \forall x\,\phi\simeq\forall y\,\phi[y\!:\!x]
    \]
\end{prop}
\begin{proof}
Suppose for now that $y\not\in\var(\phi)$. From
proposition~(\ref{logic:prop:permutation:is:substitution}) we have
the equality $\phi[y\!:\!x]=\phi[y/x]$ and the strong equivalence
$\forall x\,\phi\simeq\forall y\,\phi[y\!:\!x]$ is therefore a of
consequence $y\not\in\var(\phi)$ and
definition~(\ref{logic:def:strong:sub:congruence}). So the
conclusion of the proposition follows easily with the simple
assumption $y\not\in\var(\phi)$. Thus we may assume that
$y\in\var(\phi)$ from now on. Suppose now that $\psi\in\pv$ is such
that $y\not\in\var(\psi)$ and $\phi\simeq\psi$. Then for the reasons
just indicated we obtain $\forall x\,\psi\simeq\forall
y\,\psi[y\!:\!x]$. Furthermore, the strong substitution congruence
being a congruent relation on \pv, from $\phi\simeq\psi$ we have
$\forall x\,\phi\simeq\forall x\,\psi$ and $\forall
y\,\phi[y\!:\!x]\simeq\forall y\,\psi[y\!:\!x]$, where we have used
the fact that $\phi[y\!:\!x]\simeq\psi[y\!:\!x]$ which itself
follows from the injectivity of $[y\!:\!x]:V\to V$ and
proposition~(\ref{logic:prop:strong:injective:substitution}). By
transitivity it follows that $\forall x\,\phi\simeq\forall
y\,\phi[y\!:\!x]$ and the proposition is proved. Thus, it is
sufficient to show the existence of $\psi\in\pv$ with
$y\not\in\var(\psi)$ and $\phi\simeq\psi$. Having assumed the
existence of $z\in V$ such that $z\not\in\var(\phi)$, let
$\psi\in\pv$ be defined as $\psi=\phi[z/y]$. Note in particular that
$z\neq y$ since we have assumed $y\in\var(\phi)$. The fact that
$y\not\in\var(\psi)$ follows immediately from $z\neq y$ and
proposition~(\ref{logic:prop:inplaceof:notvar}). So it remains to
show that $\phi\simeq\psi$ or equivalently that
$\phi\simeq\phi[z/y]$ which is a consequence of
proposition~(\ref{logic:prop:substitution:invariant}) and the facts
that $z\not\in\var(\phi)$ and $y\not\in\free(\phi)$.
\end{proof}

\begin{prop}\label{logic:prop:FOPL:subcongvstrong:reverse}
Let $\sim$ be the substitution congruence and $\simeq$ be the strong
substitution congruence on \pv\ where $V$ is a set. Let
$\phi,\psi\in\pv$ be such that $\var(\phi)\neq V$. Then we have the
equivalence:
    \[
    \phi\simeq\psi\ \Leftrightarrow\
    \phi\sim\psi
    \]
\end{prop}
\begin{proof}
The implication $\Rightarrow$ follows from
proposition~(\ref{logic:prop:strong:implies:quant}). So we need to
prove $\Leftarrow$\,. Specifically, given $\phi\in\pv$, we need to
show that $\phi$ satisfies the property:
    \[
    \var(\phi)\neq V\ \Rightarrow\ \forall\psi[\,\phi\sim\psi\
    \Rightarrow\ \phi\simeq\psi\,]
    \]
We shall do so by a structural induction argument, using
theorem~(\ref{logic:the:proof:induction}) of
page~\pageref{logic:the:proof:induction}. First we assume that
$\phi=(x\in y)$ for some $x,y\in V$. As we shall see the condition
$\var(\phi)\neq V$ will not be used here. So let $\psi\in\pv$ such
that $\phi\sim\psi$. It is sufficient to prove that
$\phi\simeq\psi$. In fact it is sufficient to show that $\phi=\psi$
which follows immediately from $\phi=(x\in y)$ and $\phi\sim\psi$,
using theorem~(\ref{logic:the:sub:congruence:charac}) of
page~\pageref{logic:the:sub:congruence:charac}. So we now assume
that $\phi=\bot$. Then again from
theorem~(\ref{logic:the:sub:congruence:charac}) the condition
$\phi\sim\psi$ implies that $\phi=\psi$ and we are done. So we now
assume that $\phi=\phi_{1}\to\phi_{2}$ where
$\phi_{1},\phi_{2}\in\pv$ satisfy our property. We need to show the
same is true of $\phi$. So we assume that $\var(\phi)\neq V$ and we
consider $\psi\in\pv$ such that $\phi\sim\psi$. We need to show that
$\phi\simeq\psi$. However, using
theorem~(\ref{logic:the:sub:congruence:charac}) once more the
condition $\phi\sim\psi$ implies that $\psi$ must be of the form
$\psi=\psi_{1}\to\psi_{2}$ where $\phi_{1}\sim\psi_{1}$ and
$\phi_{2}\sim\psi_{2}$. Hence the strong substitution $\simeq$ being
a congruent relation, in order to show $\phi\simeq\psi$ it is
sufficient to prove that $\phi_{1}\simeq\psi_{1}$ and
$\phi_{2}\simeq\psi_{2}$. Having assumed our induction property is
true for $\phi_{1}$, it follows from
$\var(\phi_{1})\subseteq\var(\phi)$ that $\var(\phi_{1})\neq V$ and
$\phi_{1}\simeq\psi_{1}$ is therefore an immediate consequence of
$\phi_{1}\sim\psi_{1}$. We prove similarly that
$\phi_{2}\simeq\psi_{2}$ which completes the case when
$\phi=\phi_{1}\to\phi_{2}$. We now assume that $\phi=\forall
x\phi_{1}$ where $x\in V$ and $\phi_{1}\in\pv$ satisfies our
property. We need to show the same is true for $\phi$. So we assume
that $\var(\phi)\neq V$ and consider $\psi\in\pv$ such that
$\phi\sim\psi$. We need to show that $\phi\simeq\psi$. From
theorem~(\ref{logic:the:sub:congruence:charac}), the condition
$\phi\sim\psi$ leads to two possible cases: $\psi$ must be of the
form $\psi=\forall x\psi_{1}$ with $\phi_{1}\sim\psi_{1}$, or it
must be of the form $\psi=\forall y\psi_{1}$ with $x\neq y$,
$\psi_{1}\sim\phi_{1}[y\!:\!x]$ and $y\not\in\free(\phi_{1})$. First
we assume that $\psi=\forall x\psi_{1}$ which
$\phi_{1}\sim\psi_{1}$. Then in order to show that $\phi\simeq\psi$
it is sufficient to prove that $\phi_{1}\simeq\psi_{1}$. Having
assumed our induction property is true for $\phi_{1}$, it follows
from $\var(\phi_{1})\subseteq\var(\phi)$ that $\var(\phi_{1})\neq V$
and $\phi_{1}\simeq\psi_{1}$ is therefore an immediate consequence
of $\phi_{1}\sim\psi_{1}$. So we now consider the second case when
$\psi=\forall y\psi_{1}$ with $x\neq y$,
$\psi_{1}\sim\phi_{1}[y\!:\!x]$ and $y\not\in\free(\phi_{1})$. We
need to show that $\phi\simeq\psi$. However, using
proposition~(\ref{logic:prop:sub:congruence:injective:substitution})
and the fact that $[y\!:\!x]:V\to V$ is an injective map such that
$[y\!:\!x]\circ[y\!:\!x]$ is the identity mapping, we obtain
immediately $\psi_{1}[y\!:\!x]\sim\phi_{1}$. Having assumed our
property is true for $\phi_{1}$, from $\var(\phi_{1})\neq V$ we
obtain $\psi_{1}[y\!:\!x]\simeq\phi_{1}$. Composing once again on
both side by $[y\!:\!x]$ we now argue from
proposition~(\ref{logic:prop:strong:injective:substitution}) that
$\psi_{1}\simeq\phi_{1}[y\!:\!x]$. Thus in order to show that
$\phi\simeq\psi$ it is sufficient to prove that $\forall
x\phi_{1}\simeq\forall y\phi_{1}[y\!:\!x]$ which follows immediately
from proposition~(\ref{logic:prop:link:strong:sub:congruence}),
$y\not\in\free(\phi_{1})$ and $\var(\phi_{1})\neq V$.
\end{proof}

So it is now clear that the substitution congruence and strong
substitution congruence are pretty much the same thing. We just need
to bear in mind that an equivalence $\phi\sim\psi$ may fail to imply
a strong equivalence $\phi\simeq\psi$ in the case when all variables
of $V$ have been used up by both $\phi$ and $\psi$. We shall
conclude this section by providing counterparts to
proposition~(\ref{logic:prop:admissible:sub:congruence}) and
proposition~(\ref{logic:prop:sub:congruence:from:admissible}) for
the strong substitution congruence.

\begin{prop}\label{logic:prop:admissible:strong}
Let $\simeq$ be the strong substitution congruence on \pv\ where $V$
is a set. Let $\phi\in\pv$ and $\sigma:V\to V$ be an admissible
substitution for $\phi$ such that $\var(\sigma(\phi))\neq V$. Then,
we have:
    \[
    \phi\simeq\sigma(\phi)
    \]
\end{prop}
\begin{proof}
Let $\sim$ be the substitution congruence on \pv. Having assumed
$\sigma$ is admissible for $\phi$, using
proposition~(\ref{logic:prop:admissible:sub:congruence}) we obtain
$\phi\sim\sigma(\phi)$. Since $\var(\sigma(\phi))\neq V$ we conclude
from proposition~(\ref{logic:prop:FOPL:subcongvstrong:reverse}) that
$\phi\simeq\sigma(\phi)$.
\end{proof}

Proposition~(\ref{logic:prop:admissible:strong}) allows us to state
another characterization of the strong substitution congruence as
the following proposition shows. In
definition~(\ref{logic:def:strong:sub:congruence}), the strong
substitution congruence was defined in terms of a generator:
 \[
    R_{0}=\{(\phi,\sigma(\phi))\ :\ \phi=\forall x\phi_{1}\ ,\
    \sigma=[y/x]\ ,x\neq y\ , \ y\not\in\var(\phi_{1})\}
 \]
As we shall soon discover, this generator is in fact a subset of the
set $R_{1}$ of ordered pairs $(\phi,\sigma(\phi))$ where $\sigma$ is
admissible for $\phi$ and such that $\var(\sigma(\phi))\neq V$.
Since we now know from
proposition~(\ref{logic:prop:admissible:strong}) that $R_{1}$ is
itself a subset of the strong substitution congruence, it follows
that $R_{1}$ is also a generator of the strong substitution
congruence, which we shall now prove formally:

\begin{prop}\label{logic:prop:strong:quant:congruence:from:admissible}
Let $V$ be a set. Then the strong substitution congruence on \pv\ is
also generated by the following set $R_{1}\subseteq \pv\times\pv$:
    \[
    R_{1}=\left\{\,(\,\phi\,,\,\sigma(\phi)\,):\phi\in\pv\ ,\
    \mbox{$\sigma:V\to V$ admissible for $\phi$}\ ,\
    \var(\sigma(\phi))\neq V\ \right\}
    \]
\end{prop}
\begin{proof}
Let $\simeq$ denote the strong substitution congruence on \pv\ and
$\equiv$ be the congruence on \pv\ generated by $R_{1}$. We need to
show that $\simeq\,=\,\equiv\,$. First we show that
$\simeq\,\subseteq\,\equiv\,$. Since $\simeq$ is the smallest
congruence on \pv\ which contains the set $R_{0}$ of
definition~(\ref{logic:def:strong:sub:congruence}), in order to
prove $\simeq\,\subseteq\,\equiv$ it is sufficient to prove that
$R_{0}\subseteq\,\equiv\,$. So let $\phi_{1}\in\pv$ and $x,y\in V$
be such that $x\neq y$ and $y\not\in\var(\phi_{1})$. Define
$\phi=\forall x\phi_{1}$ and $\psi=\forall y\,\phi_{1}[y/x]$. We
need to show that $\phi\equiv\psi$. The congruence $\equiv$ being
generated by $R_{1}$ it is sufficient to prove that $(\phi,\psi)\in
R_{1}$. However, if we define $\sigma:V\to V$ by setting
$\sigma=[y/x]$ we have:
    \[
    \psi=\forall
    y\,\phi_{1}[y/x]=\forall\sigma(x)\,\sigma(\phi_{1})=\sigma(\forall
    x\phi_{1})=\sigma(\phi)
    \]
Hence, in order to show $(\phi,\psi)\in R_{1}$, it is sufficient to
prove that $\sigma$ is an admissible substitution for $\phi$ and
furthermore that $\var(\sigma(\phi))\neq V$. The fact that
$\var(\sigma(\phi))\neq V$ follows immediately from
$x\not\in\var(\phi[y/x])$, which is itself a consequence of $x\neq
y$ and proposition~(\ref{logic:prop:inplaceof:notvar}). So we need
to show that $\sigma$ is an admissible substitution for $\phi$.
First we show that $\sigma$ is valid for $\phi=[y/x]$. This follows
immediately from
proposition~(\ref{logic:prop:FOPL:validsub:singlevar}) and the fact
that $y$ is not an element of $\var(\phi)=\var(\phi_{1})\cup\{x\}$.
Next we show that $\sigma(u)=u$ for all $u\in\free(\phi)$. So let
$u\in\free(\phi)=\free(\phi_{1})\setminus\{x\}$. Then in particular
$u\neq x$ and consequently $\sigma(u)=[y/x](u)=u$. This completes
our proof of $\simeq\,\subseteq\,\equiv\,$. We now show that
$\equiv\,\subseteq\,\simeq\,$. Since $\equiv$ is the smallest
congruence on \pv\ which contains the set $R_{1}$, it is sufficient
to show that $R_{1}\,\subseteq\,\simeq\,$. So let $\phi\in\pv$ and
$\sigma:V\to V$ be an admissible substitution for $\phi$ such that
$\var(\sigma(\phi))\neq V$. We need to show that
$\phi\simeq\sigma(\phi)$. But this follows immediately from
proposition~(\ref{logic:prop:admissible:strong}).
\end{proof}

From
proposition~(\ref{logic:prop:strong:quant:congruence:from:admissible})
the strong substitution congruence is generated by the set of
ordered pairs $(\phi,\sigma(\phi))$ where $\sigma$ is admissible for
$\phi$ and such that $\var(\sigma(\phi))\neq V$. This is also a flaw
of the strong substitution congruence as we feel the condition
$\var(\sigma(\phi))\neq V$ should not be there. In contrast, as can
be seen from
proposition~(\ref{logic:prop:sub:congruence:from:admissible}), the
substitution congruence does not suffer from this condition, as it
is simply generated by the set of ordered pairs
$(\phi,\sigma(\phi))$ where $\sigma$ is admissible for $\phi$.
Whichever way we look at it, it is clear that the substitution
congruence is a better notion to look at than the strong
substitution congruence. In many respects, it is also a lot simpler.
Before we close this section, we may go back to a question we raised
before defining the strong substitution congruence in
page~\pageref{logic:def:strong:sub:congruence}. We decided to define
the strong substitution in terms of ordered pairs $(\forall
x\phi_{1},\forall y\phi_{1}[y/x])$ where $x\neq y$ and
$y\not\in\var(\phi_{1})$. What if we had opted for the condition
'{\em $[y/x]$ valid for $\forall x\phi_{1}$}' rather than
'$y\not\in\var(\phi_{1})$'? It is now clear from
proposition~(\ref{logic:prop:admissible:strong}) that this would
have yielded a congruence identical to the strong substitution
congruence. So we did well to keep it simple.
