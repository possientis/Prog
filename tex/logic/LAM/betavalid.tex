In the following definition, we attempt to formalize the idea that a
$\beta$-substitution as defined in definition~(\ref{logic:def:LAM:beta:subst})
does not give rise to {\em variable capture}. Given a map $\sigma:V\to\tv$,
we define a map $\kappa_{\sigma}:\tv\to{\cal P}(V)\to\{0,1\}$, the
interpretation of which is as follows: given $\phi\in\tv$ and $U\subseteq V$, 
a value of $\kappa_{\sigma}(\phi)(U)=0$ indicates that {\em variable capture} 
did occur in the substitution $\sigma^{*}(\phi)(U)$ of
definition~(\ref{logic:def:LAM:beta:subst}), indicating that the substitution
is not valid (in relation to $U$) for the formula $\phi$. Otherwise,
if $\kappa_{\sigma}(\phi)(U)=1$ then no {\em variable capture} did occur,
and the ordered pair $(\sigma,U)$ is said to be {\em valid} for $\phi$.
In the case when $\phi=x$ for some $x\in V$, we set $\kappa_{\sigma}(\phi)
(U)=1$ since no {\em variable capture} can arise as a result of the variable
substitution. When $\phi=\phi_{1}\ \phi_{2}$ we set $\kappa_{\sigma}(\phi)(U)$
to be the minimum of $\kappa_{\sigma}(\phi_{1})(U)$ and $\kappa_{\sigma}
(\phi_{2})(U)$, taking the view that no {\em variable capture}
arises from the variable substitution, unless it arises for $\phi_{1}$ or 
$\phi_{2}$. The case when $\phi=\lambda x\phi_{1}$ is the most diffcult
one: since we have:
    \[
        \sigma^{*}(\lambda x \phi_{1})(U)
        =
        \lambda x \,\sigma^{*}(\phi_{1})(U\cup\{x\})
    \]
a necessary condition to avoid {\em variable capture} is that no {\em 
variable capture} occurs in $\sigma^{*}(\phi_{1})(U\cup\{x\})$. However,
we also expect any $u\in\free(\lambda x\phi_{1})\setminus U$ to be 
{\em replaced} by $\sigma(u)$ after the substitution. Hence we must have
$x\not\in\free(\sigma(u))$, as otherwise a free variable of $\sigma(u)$
would get {\em captured} by $x$. This motivate the following:
\begin{defin}\label{logic:def:LAM:beta:valid:substitution}
    Let $V$ be a set and $\sigma:V\to\tv$ be a map. We call {\em validity
    index mapping associated with $\sigma$} the map $\kappa_{\sigma}:\tv
    \to{\cal P}(V)\to\{0,1\}$ defined by the following structural induction,
    given $\phi\in\tv$ and $U\subseteq V$:
        \begin{equation}\label{logic:eqn:LAM:index}
            \kappa_{\sigma}(\phi)(U)=\left\{
                \begin{array}{lcl}
                    1&\mbox{\ if\ }&\phi=x\\
                    \kappa_{\sigma}(\phi_{1})(U)\,\land\,
                    \kappa_{\sigma}(\phi_{2})(U)
                    &\mbox{\ if\ }&\phi=\phi_{1}\ \phi_{2}\\
                    \epsilon\,\land\,\kappa_{\sigma}(\phi_{1})(U\cup\{x\})
                    &\mbox{\ if\ }&\phi=\lambda x\phi_{1}
            \end{array}\right.
        \end{equation} 
    where it is understood in the above equation that $\epsilon\in\{0,1\}$ 
    and $\epsilon=1$ holds \ifand\ the following implication is true 
    for all $u\in V$:
        \[
            u\in\free(\lambda x\phi_{1})\setminus U
                \ \Rightarrow\ 
            x\not\in\free(\sigma(u))
        \]
    We say that $(\sigma,U)$ is {\em $\beta$-valid for} $\phi$ \ifand\ 
    $\kappa_{\sigma}(\phi)(U)=1$. \newline
    We say that $\sigma$ is $\beta$-valid for $\phi$ \ifand\
    $(\sigma,\emptyset)$ is $\beta$-valid for $\phi$.
\end{defin}

\begin{prop}\label{logic:prop:LAM:beta:valid:recursion:x:gen}
    Let $V$ be a set and $\sigma:V\to\tv$ be a map. Let $\phi\in\tv$
    of the form $\phi=x$ with $x\in V$. Then for all $U\subseteq V$, 
    $(\sigma,U)$ is $\beta$-valid for $\phi$.
\end{prop}
\begin{proof}
    This follows immediately from 
    definition~(\ref{logic:def:LAM:beta:valid:substitution}) and $\kappa_{
        \sigma}(\phi)(U)=1$.
\end{proof}
\begin{prop}\label{logic:prop:LAM:beta:valid:recursion:x}
    Let $V$ be a set and $\sigma:V\to\tv$ be a map. Let $\phi\in\tv$
    of the form $\phi=x$ with $x\in V$. Then 
    $\sigma$ is $\beta$-valid for $\phi$.
\end{prop}
\begin{proof}
    This follows immediately from 
    proposition~(\ref{logic:prop:LAM:beta:valid:recursion:x:gen}) using 
    $U=\emptyset$.
\end{proof}

\begin{prop}\label{logic:prop:LAM:beta:valid:recursion:app:gen}
    Let $V$ be a set and $\sigma:V\to\tv$ be a map. Let $\phi\in\tv$ 
    of the form $\phi=\phi_{1}\ \phi_{2}$ with $\phi_{1},\phi_{2}\in\tv$. 
    Then for all $U\subseteq V$,  $(\sigma,U)$ is $\beta$-valid for $\phi$ 
    \ifand\ it is $\beta$-valid for both $\phi_{1}$ and $\phi_{2}$.
\end{prop}
\begin{proof}
    $(\sigma,U)$ is $\beta$-valid for $\phi$ \ifand\ $\kappa_{\sigma}(\phi)(U)
    =1$ which is the same as $\kappa_{\sigma}(\phi_{1})(U)\land\kappa_{\sigma}
    (\phi_{2})(U)=1$. This in turn is equivalent to $\kappa_{\sigma}
    (\phi_{1})(U)=1$ and $\kappa_{\sigma}(\phi_{2})(U)=1$. So it is 
    equivalent to $(\sigma,U)$ being $\beta$-valid for both $\phi_{1}$ and
    $\phi_{2}$.
\end{proof}

\begin{prop}\label{logic:prop:LAM:beta:valid:recursion:app}
    Let $V$ be a set and $\sigma:V\to\tv$ be a map. Let $\phi\in\tv$ 
    of the form $\phi=\phi_{1}\ \phi_{2}$ with $\phi_{1},\phi_{2}\in\tv$. 
    Then $\sigma$ is $\beta$-valid for $\phi$ 
    \ifand\ it is $\beta$-valid for both $\phi_{1}$ and $\phi_{2}$.
\end{prop}
\begin{proof}
    This follows immediately from 
    proposition~(\ref{logic:prop:LAM:beta:valid:recursion:app:gen}) using 
    $U=\emptyset$.
\end{proof}

\begin{prop}\label{logic:prop:LAM:beta:valid:recursion:lam:gen}
    Let $V$ be a set and $\sigma:V\to\tv$ be a map. Let $\phi\in\tv$ 
    of the form $\phi=\lambda x\phi_{1}$ with $\phi_{1}\in\tv$ and $x\in V$. 
    Then for all $U\subseteq V$, $(\sigma,U)$ is $\beta$-valid for $\phi$ 
    \ifand\ $(\sigma, U\cup\{x\})$ is $\beta$-valid for $\phi_{1}$ and for 
    all $u\in V$:
    \[
        u\in\free(\lambda x\phi_{1})\setminus U
        \ \Rightarrow\ 
        x\not\in\free(\sigma(u))
    \]
\end{prop}
\begin{proof}
    From definition~(\ref{logic:def:LAM:beta:valid:substitution}), $(\sigma,U)$
    is $\beta$-valid for $\phi$ \ifand\ $\kappa_{\sigma}(\phi)(U)=1$ which is
    $\epsilon\land\kappa_{\sigma}(\phi_{1})(U\cup\{x\})=1$. This is turn is
    equivalent to $\kappa_{\sigma}(\phi_{1})(U\cup\{x\})=1$ together with 
    $\epsilon=1$. So it is equivalent to $(\sigma,U\cup\{x\})$ being 
    $\beta$-valid for $\phi_{1}$ together with $\epsilon=1$. The proposition
    follows from the fact that $\epsilon=1$ is itself equivalent to the
    above implication being true for all $u\in V$.
\end{proof}
\begin{prop}\label{logic:prop:LAM:beta:valid:recursion:lam}
    Let $V$ be a set and $\sigma:V\to\tv$ be a map. Let $\phi\in\tv$ 
    of the form $\phi=\lambda x\phi_{1}$ with $\phi_{1}\in\tv$ and $x\in V$. 
    Then $\sigma$ is $\beta$-valid for $\phi$ 
    \ifand\ $(\sigma, \{x\})$ is $\beta$-valid for $\phi_{1}$ and for 
    all $u\in V$:
    \[
        u\in\free(\lambda x\phi_{1})
        \ \Rightarrow\ 
        x\not\in\free(\sigma(u))
    \]
\end{prop}
\begin{proof}
    This follows immediately from 
    proposition~(\ref{logic:prop:LAM:beta:valid:recursion:lam:gen}) using 
    $U=\emptyset$.
\end{proof}

\begin{prop}\label{logic:prop:LAM:beta:valid:monotone}
    Let $V$ be a set and $\sigma:V\to\tv$ be a map. Let $\phi\in\tv$ and
    $U,U'\subseteq V$. Then if $U\subseteq U'$, we have the implication:
        \[
            (\sigma,U)\mbox{\ $\beta$-valid for $\phi$}
            \ \Rightarrow\
            (\sigma,U')\mbox{\ $\beta$-valid for $\phi$}
        \]
\end{prop}
\begin{proof}
    We need to show the implication holds whenever $U\subseteq U'$. We shall 
    do so by structural induction on $\phi$, using 
    theorem~(\ref{logic:the:proof:induction}) of 
    page~\pageref{logic:the:proof:induction}. So first we assume that
    $\phi=x$ for some $x\in V$. Using
    proposition~(\ref{logic:prop:LAM:beta:valid:recursion:x:gen}), 
    $(\sigma,U')$ is always $\beta$-valid for $\phi$ and the implication
    is true. So we now assume that $\phi=\phi_{1}\ \phi_{2}$ for some
    $\phi_{1},\phi_{2}\in\tv$ for which the implication is true whenever
    $U\subseteq U'$. We assume that $U\subseteq U'$ and we need to show that 
    the implication is also true for $\phi$. So we assume that $(\sigma,U)$
    is $\beta$-valid for $\phi$, and we need to show that $(\sigma,U')$ is
    $\beta$-valid for $\phi$. Using
    proposition~(\ref{logic:prop:LAM:beta:valid:recursion:app:gen}), 
    this is equivalent to showing that $(\sigma,U')$ is $\beta$-valid
    for both $\phi_{1}$ and $\phi_{2}$. Having assumed the implication
    is true for $\phi_{1}$ and $\phi_{2}$ whenever $U\subseteq U'$, it is
    sufficient to show that $(\sigma,U)$ is $\beta$-valid for both
    $\phi_{1}$ and $\phi_{2}$ which follows again from
    proposition~(\ref{logic:prop:LAM:beta:valid:recursion:app:gen}) and
    the $\beta$-validity of $(\sigma,U)$ for~$\phi$.
    So we now assume that $\phi=\lambda x\phi_{1}$ for some $x\in V$, and 
    some $\phi_{1}\in\tv$ for which the implication is true whenever 
    $U\subseteq U'$. We assume that $U\subseteq U'$ and we need to show
    the implication is also true for $\phi$. So we assume that $(\sigma,U)$
    is $\beta$-valid for $\phi$ and we need to show that $(\sigma,U')$ is
    $\beta$-valid for $\phi$. Using
    proposition~(\ref{logic:prop:LAM:beta:valid:recursion:lam:gen}) it is
    sufficient to show that $(\sigma,U'\cup\{x\})$ is $\beta$-valid for 
    $\phi_{1}$, and furthermore that for all $u\in V$, the following 
    implication holds:
    \[
        u\in\free(\lambda x\phi_{1})\setminus U'
        \ \Rightarrow\ 
        x\not\in\free(\sigma(u))
    \]
    First we focus on the implication. Having assumed that $U\subseteq U'$
    it is sufficient to show a similar implication where $U'$ is replaced by $U$:
    \[
        u\in\free(\lambda x\phi_{1})\setminus U
        \ \Rightarrow\ 
        x\not\in\free(\sigma(u))
    \]
    This last implication follows from another use of
    proposition~(\ref{logic:prop:LAM:beta:valid:recursion:lam:gen}) and the
    fact that $(\sigma,U)$ is $\beta$-valid for $\phi$. So it remains to 
    show that $(\sigma,U'\cup\{x\})$ is $\beta$-valid for $\phi_{1}$.
    Having assumed the implication is true for $\phi_{1}$ and since 
    $U\cup\{x\}\subseteq U'\cup\{x\}$, it is sufficient to show that 
    $(\sigma, U\cup\{x\})$ is $\beta$-valid for $\phi_{1}$, which 
    follows once again from
    proposition~(\ref{logic:prop:LAM:beta:valid:recursion:lam:gen}) and the
    fact that $(\sigma,U)$ is $\beta$-valid for $\phi$.
\end{proof}

\begin{prop}\label{logic:prop:LAM:freevar:of:betasubst:valid:gen}
    Let $V$ be a set and $\phi\in\tv$. Let $\sigma:V\to\tv$ be a map and
    $U\subseteq V$ such that $(\sigma,U)$ is $\beta$-valid for $\phi$. Then: 
    \[
        \free(\sigma^{*}(\phi)(U)) 
            \ =\ 
        (\free(\phi)\cap U)
        \ \cup
        \!\!\!\!\!\!
        \bigcup_{x\in\free(\phi)\setminus U} 
        \!\!\!\!\!\!
        \free(\sigma(x))
    \]
    where $\sigma^{*}:\tv\to[{\cal P}(V)\to\tv]$ is defined as in 
    definition~(\ref{logic:def:LAM:beta:subst}).
\end{prop}
\begin{proof}
    We shall prove the equality is true whenever $(\sigma,U)$ is $\beta$-valid
    for $\phi$ by structural induction on $\phi$, using
    theorem~(\ref{logic:the:proof:induction}) of 
    page~\pageref{logic:the:proof:induction}. So first we assume that $\phi=x$ 
    for some $x\in V$. Let $U\subseteq V$. Note that from
    proposition~(\ref{logic:prop:LAM:beta:valid:recursion:x:gen}) it is 
    always the case that $(\sigma,U)$ is $\beta$-valid for $\phi$. So 
    we simply need to establish the equality and we shall distinguish
    two cases, either $x\in U$ or $x\not\in U$. If $x\in U$ we have:
    \begin{eqnarray*}
        \free(\sigma^{*}(\phi)(U))
        &=&\free(\sigma^{*}(x)(U))\\
        &=&\free(\sigma_{U}(x))\\
        \mbox{$x\in U\ \rightarrow\ $}&=&\free(x)\\
         &=&\{x\}\\
         &=&\free(\phi)\\
        \mbox{$x\in U\ \rightarrow\ $}&=&\free(\phi)\cap U\\
        \mbox{$\free(\phi)\setminus U = \emptyset\ \rightarrow\ $} &=& 
            (\free(\phi)\cap U)
            \ \cup
            \!\!\!\!\!\!
            \bigcup_{x\in\free(\phi)\setminus U} 
            \!\!\!\!\!\!
            \free(\sigma(x))
    \end{eqnarray*}
    If $x\not\in U$, then:
    \begin{eqnarray*}
        \free(\sigma^{*}(\phi)(U))
        &=&\free(\sigma^{*}(x)(U))\\
        &=&\free(\sigma_{U}(x))\\
        \mbox{$x\not\in U\ \rightarrow\ $}&=&\free(\sigma(x))\\
        &=&
        \!\!\!
        \bigcup_{u\in\{x\}} 
        \!\!
        \free(\sigma(u))\\
        &=&
        \!\!\!\!\!
        \bigcup_{u\in\free(\phi)} 
        \!\!\!\!
        \free(\sigma(u))\\
        \mbox{$x\not\in U\ \rightarrow\ $}
        &=&
        \!\!\!\!\!\!\!\!
        \bigcup_{u\in\free(\phi)\setminus U} 
        \!\!\!\!\!\!\!\!
        \free(\sigma(u))\\
        \mbox{$\free(\phi)\cap U = \emptyset\ \rightarrow\ $} 
        &=& 
        (\free(\phi)\cap U)
        \ \cup
        \!\!\!\!\!\!\!
        \bigcup_{x\in\free(\phi)\setminus U} 
        \!\!\!\!\!\!\!
        \free(\sigma(x))
    \end{eqnarray*}
    We now assume that $\phi=\phi_{1}\ \phi_{2}$ where $\phi_{1}, \phi_{2}
    \in\tv$ satisfy the equality whenever $(\sigma,U)$ is $\beta$-valid. 
    Let $U\subseteq V$ such that $(\sigma,U)$ is $\beta$-valid for $\phi$.
    Using proposition~(\ref{logic:prop:LAM:beta:valid:recursion:app:gen}),
    $(\sigma,U)$ is $\beta$-valid for both $\phi_{1}$ and $\phi_{2}$.
    Hence we have:
    \begin{eqnarray*}
        \free(\sigma^{*}(\phi)(U))
        &=&\free(\sigma^{*}(\phi_{1}\ \phi_{2})(U))\\
        &=&\free(\ \sigma^{*}(\phi_{1})(U)\ \ \sigma^{*}(\phi_{2})(U)\ )\\
        &=&\free(\sigma^{*}(\phi_{1})(U))\ \cup\ \free(\sigma^{*}(\phi_{2})(U))\\
        \mbox{$(\sigma,U)$ $\beta$-valid for $\phi_{1}\ \rightarrow\ $}
        &=&(\free(\phi_{1})\cap U)
        \ \cup\ 
        \!\!\!\!\!\!\!\!\!\!
        \bigcup_{x\in\free(\phi_{1})\setminus U} 
        \!\!\!\!\!\!\!\!
        \free(\sigma(x))\\
        \mbox{$(\sigma,U)$ $\beta$-valid for $\phi_{2}\ \rightarrow\ $}
        &\cup&(\free(\phi_{2})\cap U)
        \ \cup\ 
        \!\!\!\!\!\!\!\!\!\!
        \bigcup_{x\in\free(\phi_{2})\setminus U} 
        \!\!\!\!\!\!\!\!
        \free(\sigma(x))\\
        &=&(\free(\phi_{1})\cup\free(\phi_{2}))\cap U
        \ \cup\ 
        \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!
        \bigcup_{x\in(\free(\phi_{1})\cup\free(\phi_{2}))\setminus U}
        \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!
        \free(\sigma(x))\\
        &=&(\free(\phi)\cap U)\ \cup\ 
        \!\!\!\!\!\!\!\!
        \bigcup_{x\in\free(\phi)\setminus U}
        \!\!\!\!\!\!\!
        \free(\sigma(x))
    \end{eqnarray*}
    Finally, we assume that $\phi=\lambda x\phi_{1}$ where $\phi_{1}\in\tv$ 
    satisfies the equality for all $U\subseteq V$ such that $(\sigma,U)$ is
    $\beta$-valid for $\phi_{1}$. Let $U\subseteq V$ be such that $(\sigma,U)$
    is $\beta$-valid for $\phi$. Using
    proposition~(\ref{logic:prop:LAM:beta:valid:recursion:lam:gen}) we see 
    that $(\sigma,U\cup\{x\})$ is $\beta$-valid for $\phi_{1}$: 
    \begin{eqnarray*}\free(\ \sigma^{*}(\phi)(U)\ )
        &=&\free(\ \sigma^{*}(\lambda x\phi_{1})(U)\ )\\
        &=&\free(\ \lambda x\sigma^{*}(\phi_{1})(U\cup\{x\})\ )\\
        &=&\free(\ \sigma^{*}(\phi_{1})(U\cup\{x\})\ )\setminus\{x\}\\
        \mbox{$(\sigma,U\!\cup\!\{x\})$ $\beta$-valid for 
            $\phi_{1}\rightarrow$}
        &=& [(\free(\phi_{1})\cap(U\cup\{x\}))
        \ \cup\ 
        \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!
        \bigcup_{u\in\free(\phi_{1})\setminus(U\cup\{x\})}
        \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!
        \free(\sigma(u))
        ]\setminus\{x\}\\
        &=&(\free(\phi_{1})\cap U\cap \{x\}^{c})
        \ \cup\ 
        \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!
        \bigcup_{u\in\free(\phi_{1})\cap U^{c}\cap\{x\}^{c}}
        \!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!
        \free(\sigma(u))\setminus\{x\}\\
        &=&(\free(\lambda x\phi_{1})\cap U)
        \ \cup\ 
        \!\!\!\!\!\!\!\!\!\!\!\!\!
        \bigcup_{u\in\free(\lambda x\phi_{1})\setminus U}
        \!\!\!\!\!\!\!\!\!\!\!
        \free(\sigma(u))\setminus\{x\}\\
        &=&(\free(\phi)\cap U)
        \ \cup\ 
        \!\!\!\!\!\!\!\!\!
        \bigcup_{u\in\free(\phi)\setminus U} 
        \!\!\!\!\!\!\!
        \free(\sigma(u))\setminus\{x\}\\
        \mbox{see below $\ \rightarrow\ $}
        &=&(\free(\phi)\cap U)
        \ \cup\ 
        \!\!\!\!\!\!\!\!\!
        \bigcup_{u\in\free(\phi)\setminus U}
        \!\!\!\!\!\!\!
        \free(\sigma(u))
    \end{eqnarray*}
    In order to jusfify the last equality, it is sufficient to prove that 
    $\free(\sigma(u))\subseteq\{x\}^{c}$ for all $u\in\free(\phi)\setminus U$.
    However, by assumption $(\sigma,U)$ is $\beta$-valid for $\phi=\lambda
    x\phi_{1}$. Hence using 
    proposition~(\ref{logic:prop:LAM:beta:valid:recursion:lam:gen}) once more,
    for all $u\in V$ we have the implication $u\in\free(\phi)\setminus 
    U\Rightarrow x\not\in \free(\sigma(u))$ which is exactly what we need.
\end{proof}

\begin{prop}\label{logic:prop:LAM:freevar:of:betasubst:valid}
    Let $V$ be a set and $\phi\in\tv$. Let $\sigma:V\to\tv$ be a map which is 
    $\beta$-valid for $\phi$. Then, we have: 
    \[
        \free(\sigma(\phi))
        =
        \bigcup_{x\in\free(\phi)}\free(\sigma(x))
    \]
    where $\sigma:\tv\to\tv$ also denotes the associated $\beta$-substitution
    mapping.
\end{prop}
\begin{proof}
    This is an immediate application of
    proposition~(\ref{logic:prop:LAM:freevar:of:betasubst:valid}) with
    $U=\emptyset$, bearing in mind from
    definition~(\ref{logic:def:LAM:beta:valid:substitution}) that the 
    $\beta$-validity of $\sigma$ for $\phi$ is nothing but the $\beta$-validity
    of $(\sigma,\emptyset)$ for $\phi$, and from
    definition~(\ref{logic:def:LAM:beta:subst}) that $\sigma(\phi)=
    \sigma^{*}(\phi)(\emptyset)$.
\end{proof}

\begin{prop}\label{logic:prop:LAM:var:inter:beta:valid:gen}
    Let $V$ be a set and $\phi\in\tv$. Let $\sigma:V\to\tv$ be a map. Then for
    all $U\subseteq V$, we have the following implication:
        \[
            \var(\phi)\ \cap
            \!\!\!\!\!\!\bigcup_{u\in\free(\phi)\setminus U}\!\!\!\!\!\!
            \free(\sigma(u))\setminus\{u\}
            =\emptyset
            \ \ \Rightarrow\ \ 
            \mbox{$(\sigma,U)$ is $\beta$-valid for $\phi$}
        \]
\end{prop}
\begin{proof}
    We shall prove this implication by structural induction on $\phi$, using 
    theorem~(\ref{logic:the:proof:induction}) of 
    page~\pageref{logic:the:proof:induction}. 
    So first we assume that $\phi=x$ for some $x\in V$. Then for all $U\subseteq 
    V$, from proposition~(\ref{logic:prop:LAM:beta:valid:recursion:x:gen}) it is
    always the case that $(\sigma, U)$ is $\beta$-valid for $\phi$ and the 
    implication is therefore satisfied. So we now assume that $\phi=\phi_{1}\ 
    \phi_{2}$ for some $\phi_{1},\phi_{2}\in\tv$ for which the implication
    is true for all $U\subseteq V$. Given $U\subseteq V$, we need to show that
    the implication is also true for $\phi$. Hence we assume:
        \begin{equation}\label{logic:eqn:LAM:var:inter:beta:valid:gen}
            \var(\phi)\ \cap
            \!\!\!\!\!\!\bigcup_{u\in\free(\phi)\setminus U}\!\!\!\!\!\!
            \free(\sigma(u))\setminus\{u\}
            =\emptyset
        \end{equation}
    and we shall show that $(\sigma,U)$ is $\beta$-valid for $\phi$.
    From $\var(\phi)=\var(\phi_{1})\cup\var(\phi_{2})$
    and $\free(\phi)=\free(\phi_{1})\cup\free(\phi_{2})$, in particular
    we have:
        \[
            \var(\phi_{1})\ \cap
            \!\!\!\!\!\!\bigcup_{u\in\free(\phi_{1})\setminus U}\!\!\!\!\!\!
            \free(\sigma(u))\setminus\{u\}
            =\emptyset
        \]
    and: 
        \[
            \var(\phi_{2})\ \cap
            \!\!\!\!\!\!\bigcup_{u\in\free(\phi_{2})\setminus U}\!\!\!\!\!\!
            \free(\sigma(u))\setminus\{u\}
            =\emptyset
        \]
    Having assumed the implication is true for both $\phi_{1}$ and $\phi_{2}$ 
    we see that $(\sigma,U)$ is therefore $\beta$-valid for $\phi_{1}$ and 
    $\phi_{2}$ and the $\beta$-validity of $(\sigma,U)$ for $\phi$ follows 
    from proposition~(\ref{logic:prop:LAM:beta:valid:recursion:app:gen}).
    So we now assume that $\phi=\lambda x\phi_{1}$ for some $x\in V$ and
    some $\phi_{1}\in\tv$ for which the implication is true for all
    $U\subseteq V$. Given $U\subseteq V$, we need to show the implication
    is also true for $\phi$. So once again we assume that
    equation~(\ref{logic:eqn:LAM:var:inter:beta:valid:gen}) holds and we
    need to show that $(\sigma,U)$ is $\beta$-valid for $\phi$. Using
    proposition~(\ref{logic:prop:LAM:beta:valid:recursion:lam:gen}), we 
    therefore need to show that $(\sigma, U\cup\{x\})$ is $\beta$-valid
    for $\phi_{1}$ and furthermore that for all $u\in V$ we have:
        \[
            u\in\free(\lambda x\phi_{1})\setminus U
            \ \Rightarrow\ 
            x\not\in\free(\sigma(u))
        \]
 \end{proof}
